document.querySelectorAll(".wp-block-xlthlx-audio-player.player-container").forEach((e=>{if(e){const t=e.dataset.id;let r;const l=e.querySelector(".playlist");l&&0!==l.length&&(r=l.getElementsByClassName("track"));const n=e.querySelector(".dashicons-controls-repeat");"true"===localStorage.getItem("repeat-"+t)&&n&&n.classList.add("on");const c=e=>{let t=Math.floor(e%60);t<10&&(t="0"+t);return Math.floor(e/60)+":"+t},a=t=>{0!==r.length&&(e.querySelector(".player").src=r[t].children[0].getAttribute("href"),e.querySelector(".player").load(),e.querySelector(".play-button").click())},o=t=>{const r=t.dataset.num,l=t.dataset.title;e.querySelector(".playing").textContent=r+" - "+l},i=r=>{"true"===localStorage.getItem("repeat-"+t)?(r[0].classList.add("active"),a(0),o(r[0].children[0])):(r[r.length-1].classList.add("active"),e.querySelector(".pause-button").click())},s=r=>{"true"===localStorage.getItem("repeat-"+t)?(r[r.length-1].classList.add("active"),a(r.length-1),o(r[r.length-1].children[0])):(r[0].classList.add("active"),e.querySelector(".pause-button").click())},u=(e,t)=>{e<t.length?(t[e].classList.add("active"),a(e),o(t[e].children[0])):i(t)},d=(e,t)=>{e<t.length?(t[e].classList.add("active"),a(e),o(t[e].children[0])):s(t)},y=e=>{if(0!==r.length)for(let t=0;t<r.length;t++)r[t].classList.contains("active")&&(r[t].classList.remove("active"),"next"===e?(t++,u(t,r)):(t>0?t--:t=r.length+1,d(t,r)))},v=()=>{e.querySelector(".play-button").classList.remove("display-none"),e.querySelector(".pause-button").classList.add("display-none")},S=()=>{e.querySelector(".play-button").classList.add("display-none"),e.querySelector(".pause-button").classList.remove("display-none")},m=()=>{e.querySelector(".vol-muted-btn").classList.toggle("display-none"),e.querySelector(".vol-mute-btn").classList.toggle("display-none")},p=()=>{e.querySelector(".volume-slider").value=e.querySelector(".player").volume};e.querySelector(".vol-mute-btn").addEventListener("click",(function(){e.querySelector(".player").muted=!0,e.querySelector(".player").volume=0,p(),m(),e.querySelector(".volume-slider").style.backgroundSize="0% 100%"})),e.querySelector(".vol-muted-btn").addEventListener("click",(function(){e.querySelector(".player").muted=!1,e.querySelector(".player").volume=1,p(),m(),e.querySelector(".volume-slider").style.backgroundSize="100% 100%"})),e.querySelector(".play-button").addEventListener("click",(function(){if(0!==r.length){e.querySelector(".player").play();for(let e=0;e<r.length;e++)r[e].classList.contains("active")&&o(r[e].children[0]);S()}})),e.querySelector(".pause-button").addEventListener("click",(function(){e.querySelector(".player").pause(),v()})),e.querySelector(".next-button").addEventListener("click",(function(){y("next")})),e.querySelector(".prev-button").addEventListener("click",(function(){y("prev")}));const q=e.querySelector(".player");q.addEventListener("loadedmetadata",(function(){if(r){e.querySelector(".total-time").innerHTML=c(q.duration),e.querySelector(".current-time").innerHTML=c(q.currentTime),e.querySelector(".time-sep").innerHTML=" / ";const t=e.querySelector(".seek-slider");t.max=q.duration,t.setAttribute("value",q.currentTime)}})),q.addEventListener("timeupdate",(function(){if(r){e.querySelector(".current-time").innerHTML=c(q.currentTime);const t=e.querySelector(".seek-slider");t.setAttribute("value",q.currentTime),t.value=q.currentTime;const r=t.min,l=t.max,n=t.value;t.style.backgroundSize=100*(n-r)/(l-r)+"% 100%"}})),q.addEventListener("ended",(function(){y("next")})),e.querySelector(".seek-slider").addEventListener("input",(function(){q.currentTime=e.querySelector(".seek-slider").value}));const L=e.querySelector(".volume-slider");L.addEventListener("mousemove",(function(){q.volume=L.value;const e=L.min,t=L.max,r=L.value;L.style.backgroundSize=100*(r-e)/(t-e)+"% 100%"})),e.querySelector(".repeat").addEventListener("click",(function(){n.classList.toggle("on"),localStorage.removeItem("repeat-"+t),n.classList.contains("on")&&localStorage.setItem("repeat-"+t,"true")})),e.querySelectorAll(".item").forEach((t=>{t.addEventListener("click",(l=>{l.preventDefault(),e.querySelector(".player").src=t.href,e.querySelector(".player").load(),e.querySelector(".play-button").click(),o(t);for(let e=0;e<r.length;e++)r[e].classList.contains("active")&&r[e].classList.remove("active");t.parentElement.classList.add("active")}))}));for(let e=0;e<r.length;e++)r[e].addEventListener("click",(function(){r[e].children[0].click()}))}}));